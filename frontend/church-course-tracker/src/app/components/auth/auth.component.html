<div class="auth-container">
  <div class="auth-card">
    <mat-card>
      <mat-card-header>
        <mat-card-title>
          <div class="auth-header">
            <mat-icon class="auth-icon">church</mat-icon>
            <h2>Church Course Tracker</h2>
          </div>
        </mat-card-title>
        <mat-card-subtitle>
          {{ isLoginMode ? 'Sign in to your account' : 'Create a new account' }}
        </mat-card-subtitle>
      </mat-card-header>

      <mat-card-content>
        <!-- Login Form -->
        <form *ngIf="isLoginMode" [formGroup]="loginForm" (ngSubmit)="onLogin()" class="auth-form">
          <mat-form-field appearance="outline" class="full-width">
            <mat-label>Username</mat-label>
            <input matInput formControlName="username" autocomplete="username">
            <mat-icon matSuffix>person</mat-icon>
            <mat-error>{{ getErrorMessage(loginForm, 'username') }}</mat-error>
          </mat-form-field>

          <mat-form-field appearance="outline" class="full-width">
            <mat-label>Password</mat-label>
            <input matInput [type]="hidePassword ? 'password' : 'text'" formControlName="password" autocomplete="current-password">
            <button mat-icon-button matSuffix type="button" (click)="hidePassword = !hidePassword">
              <mat-icon>{{ hidePassword ? 'visibility_off' : 'visibility' }}</mat-icon>
            </button>
            <mat-error>{{ getErrorMessage(loginForm, 'password') }}</mat-error>
          </mat-form-field>

          <button 
            mat-raised-button 
            color="primary" 
            type="submit" 
            class="full-width auth-button"
            [disabled]="!loginForm.valid || isLoading">
            <mat-spinner *ngIf="isLoading" diameter="20"></mat-spinner>
            <span *ngIf="!isLoading">Sign In</span>
          </button>
        </form>

        <!-- Register Form -->
        <form *ngIf="!isLoginMode" [formGroup]="registerForm" (ngSubmit)="onRegister()" class="auth-form">
          <mat-form-field appearance="outline" class="full-width">
            <mat-label>Full Name</mat-label>
            <input matInput formControlName="full_name" autocomplete="name">
            <mat-icon matSuffix>person</mat-icon>
            <mat-error>{{ getErrorMessage(registerForm, 'full_name') }}</mat-error>
          </mat-form-field>

          <mat-form-field appearance="outline" class="full-width">
            <mat-label>Username</mat-label>
            <input matInput formControlName="username" autocomplete="username">
            <mat-icon matSuffix>account_circle</mat-icon>
            <mat-error>{{ getErrorMessage(registerForm, 'username') }}</mat-error>
          </mat-form-field>

          <mat-form-field appearance="outline" class="full-width">
            <mat-label>Email</mat-label>
            <input matInput formControlName="email" type="email" autocomplete="email">
            <mat-icon matSuffix>email</mat-icon>
            <mat-error>{{ getErrorMessage(registerForm, 'email') }}</mat-error>
          </mat-form-field>

          <mat-form-field appearance="outline" class="full-width">
            <mat-label>Password</mat-label>
            <input matInput [type]="hidePassword ? 'password' : 'text'" formControlName="password" autocomplete="new-password">
            <button mat-icon-button matSuffix type="button" (click)="hidePassword = !hidePassword">
              <mat-icon>{{ hidePassword ? 'visibility_off' : 'visibility' }}</mat-icon>
            </button>
            <mat-error>{{ getErrorMessage(registerForm, 'password') }}</mat-error>
          </mat-form-field>

          <mat-form-field appearance="outline" class="full-width">
            <mat-label>Confirm Password</mat-label>
            <input matInput [type]="hidePassword ? 'password' : 'text'" formControlName="confirmPassword" autocomplete="new-password">
            <mat-icon matSuffix>lock</mat-icon>
            <mat-error>{{ getErrorMessage(registerForm, 'confirmPassword') }}</mat-error>
          </mat-form-field>

          <button 
            mat-raised-button 
            color="primary" 
            type="submit" 
            class="full-width auth-button"
            [disabled]="!registerForm.valid || isLoading">
            <mat-spinner *ngIf="isLoading" diameter="20"></mat-spinner>
            <span *ngIf="!isLoading">Create Account</span>
          </button>
        </form>
      </mat-card-content>

      <mat-card-actions align="center">
        <button mat-button (click)="switchMode()" class="switch-mode-button">
          {{ isLoginMode ? "Don't have an account? Sign up" : "Already have an account? Sign in" }}
        </button>
      </mat-card-actions>
    </mat-card>
  </div>
</div>
